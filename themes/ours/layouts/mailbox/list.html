{{ define "main" }}
<div class="max-w-4xl p-4 mx-2 md:mx-auto mt-16">
    <div x-data="mailbox"
        @keydown.escape="showModal = false"
        class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-x-4 gap-y-6 md:gap-x-6 lg:gap-x-8 font-mono">
        <template x-for="letter in letters"
            :key="letter.id">
            {{/* <a :href="letter.href"
                */}}
                <a
                @click="showModal = true"
                class="flex flex-col p-4 border rounded-2xl shadow">
                <div class="flex justify-end">
                    <img loading="lazy"
                        :src="'/mailbox/stamps/'+letter.stamp+'.png'"
                        height="86"
                        width="86">
                </div>
                <p x-text="letter.summary"
                    class="h-20 my-2 overflow-hidden text-sm"></p>
                <h2 x-text="letter.category"
                    class="text-lg"></h2>
                <p x-text="letter.date"
                    class="-mt-2 text-base"></p>
            </a>
        </template>

        <div class="overflow-auto"
            x-cloak
            style="background-color: rgba(0,0,0,0.5)"
            x-show="showModal"
            :class="{ 'overflow-auto fixed inset-0 z-10 flex items-center justify-center': showModal }">

            <!--Dialog-->
            <div class="relative bg-white w-11/12 max-w-xl mx-auto mt-4 rounded shadow-lg py-4 text-left px-6"
                x-show="showModal"
                @click.away="showModal = false">

                <!--Title-->
                <div class="flex justify-between items-center pb-3">
                    <p class="text-2xl font-bold">Simple Modal!</p>
                    <div class="cursor-pointer z-50"
                        @click="showModal = false">
                        <svg class="fill-current text-black"
                            xmlns="http://www.w3.org/2000/svg"
                            width="18"
                            height="18"
                            viewBox="0 0 18 18">
                            <path
                                d="M14.53 4.53l-1.06-1.06L9 7.94 4.53 3.47 3.47 4.53 7.94 9l-4.47 4.47 1.06 1.06L9 10.06l4.47 4.47 1.06-1.06L10.06 9z">
                            </path>
                        </svg>
                    </div>
                </div>

                <!-- content -->
                <div class="relative overflow-auto h-72">
                    <p>Modal content can go here</p>
                    <p>...</p>
                    <p>...</p>
                    <p>...</p>
                    <p class="min-h-screen">...</p>
                </div>
                <!--Footer-->
                <div class="flex justify-end pt-2">
                    <button
                        class="px-4 bg-transparent p-3 rounded-lg text-indigo-500 hover:bg-gray-100 hover:text-indigo-400 mr-2"
                        @click="alert('Additional Action');">Action</button>
                    <button class="modal-close px-4 bg-indigo-500 p-3 rounded-lg text-white hover:bg-indigo-400"
                        @click="showModal = false">Close</button>
                </div>


            </div>
            <!--/Dialog -->
        </div><!-- /Overlay -->
    </div>
</div>


<script>
    document.addEventListener('alpine:init', () => {
        Alpine.data('mailbox', () => ({
            showModal: false,
            open: -1,
            letters: [
                {{ range $index, $letter:= (where $.Site.RegularPages "Section" .Section) -}}
        { id: {{ $index }}, href: "{{ .RelPermalink }}", stamp: "{{ $letter.Params.stamp }}", summary: "{{ $letter.Summary | truncate 45 }}", category: "{{ $letter.Params.category }}", date: "{{ $letter.Date | time.Format "2006年1月2日" }}"},
        {{ end }}
            ]
        }))
    });
</script>
{{ end }}